machine:
  xcode:
    version: 8.2
  node:
    version: 6.10.1
  java:
    version: oraclejdk8

test:
  override:
    - npm install -g cordova ionic
    - cd client && npm install
    - cd client && ionic build android
    - cd client && ionic build ios

deployment:
  production:
    branch: deployment
    commands:
      - npm install -g cordova ionic
      - cd client && npm install
      - cd client && ionic state restore
      - cd client && ionic build android --prod
      - chmod +x ./android_deploy.sh && ./android_deploy.sh
      - cd cleint && ionic build ios
      - cd ./client/platforms/ios/build/emulator && if [ -f Urban\ Refuge.app.dSYM.zip ]; then rm -Rf Urban\ Refuge.app.dSYM.zip; fi
      - cd ./client/platforms/ios/build/emulator && zip Urban\ Refuge.app.dSYM.zip Urban\ Refuge.app.dSYM
      - chmod +x ./ios_deploy.sh && ./ios_deploy.sh

